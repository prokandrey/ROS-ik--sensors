# ROSir-sensors
**Robot Operating System - interactive Kit**  

![–†–æ–±–æ—Ç ROSik](/images/ROSik.png)

–ú–∏–Ω–∏-—Ä–æ–±–æ—Ç –Ω–∞ **ESP32 Wroom-32 + ROS 2**, –∫–æ—Ç–æ—Ä—ã–π:
* —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –æ–¥–æ–º–µ—Ç—Ä–∏—é, –ª–∏–¥–∞—Ä –∏ –¥–∞–Ω–Ω—ã–µ –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤ –ø–æ Wi-Fi —á–µ—Ä–µ–∑ WebSocket-–º–æ—Å—Ç;
* —Å—Ç—Ä–æ–∏—Ç –∫–∞—Ä—Ç—ã –∏ –ª–æ–∫–∞–ª–∏–∑—É–µ—Ç—Å—è (`slam_toolbox`);
* –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –ø—É—Ç—å (`nav2`);
* –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å –ø–æ–º–æ—â—å—é –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤ –∏ –ª–∏–¥–∞—Ä–∞;
* –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –º–æ–¥—É–ª—è–º–∏ ‚Äî –∫–∞–º–µ—Ä–∞, IMU, –¥–∏–Ω–∞–º–∏–∫, –∞–¥—Ä–µ—Å–Ω—ã–µ LED, OLED-–¥–∏—Å–ø–ª–µ–π.

–†–∞–±–æ—Ç–∞–µ—Ç **–Ω–∞ –ª—é–±–æ–π –º–∞—à–∏–Ω–µ**: —á–∏—Å—Ç–∞—è Ubuntu 24.04, WSL 2 –ø–æ–¥ Windows –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª–∫–∞ ‚Äî –Ω—É–∂–µ–Ω –ª–∏—à—å Wi-Fi.

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ [Ubuntu](https://stepik.org/lesson/1505338/step/1?unit=1525484), [WSL](https://stepik.org/lesson/1505339/step/4?unit=1525485), –∞ —Ç–∞–∫–∂–µ  [–∑–∞–ø—É—Å–∫—É –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (RVIZ)](https://stepik.org/lesson/1505339/step/5?unit=1525485).

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å (BOM)](#–∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è-—á–∞—Å—Ç—å-bom)  
2. [–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞](#—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è-—Å—Ö–µ–º–∞)  
3. [3D-–º–æ–¥–µ–ª–∏ –∏ —Å–±–æ—Ä–∫–∞](#3d-–º–æ–¥–µ–ª–∏-–∏-—Å–±–æ—Ä–∫–∞)  
4. [–ü—Ä–æ—à–∏–≤–∫–∞ ESP32](#–ø—Ä–æ—à–∏–≤–∫–∞-esp32)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PID –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-pid)
6. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–¥ –≤ ROS2](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–ø–æ-–Ω–∞-–ø–∫)  
7. [–ó–∞–ø—É—Å–∫ ROS 2-–Ω–æ–¥](#–∑–∞–ø—É—Å–∫-ros-2-–Ω–æ–¥)  
8. [–ö–æ–Ω—Ç–∞–∫—Ç—ã](#–∫–æ–Ω—Ç–∞–∫—Ç—ã)

---

## üõí<a id="–∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è-—á–∞—Å—Ç—å-bom">–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å (BOM)</a>

* | 1 | **ESP32 Wroom-32 DevKit**         | https://aliexpress.ru/item/1005006697750568.html
* | 2 | DC-–º–æ—Ç–æ—Ä N20 60 RPM + —ç–Ω–∫–æ–¥–µ—Ä     | https://aliexpress.ru/item/1005007145668771.html
* | 3 | –î—Ä–∞–π–≤–µ—Ä –º–æ—Ç–æ—Ä–æ–≤ ZK-5AD            | https://aliexpress.ru/item/1005005798367960.html
* | 4 | –õ–∏–¥–∞—Ä                             | https://aliexpress.ru/item/1005008371059417.html
* | 5 | –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä 18650 √ó 2 + –¥–µ—Ä–∂–∞—Ç–µ–ª—å | https://aliexpress.ru/item/1005005447141518.html
* | 6 | –ü–æ–Ω–∏–∂–∞—é—â–∏–π DC-DC                  | https://aliexpress.ru/item/32896699470.html
* | 7 | –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø–∏—Ç–∞–Ω–∏—è             | https://aliexpress.ru/item/4000973563250.html
* | 8 | Type-C –∑–∞—Ä—è–¥–∫–∞  2S 1A             | https://aliexpress.ru/item/1005006628986640.html
* | 9 | –ò–ö-–¥–∞—Ç—á–∏–∫ √ó 2                     | https://aliexpress.ru/item/1005001456186405.html

---

## üîå <a id="—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è-—Å—Ö–µ–º–∞">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞</a>

–§–∞–π–ª—ã —Å—Ö–µ–º—ã:
* CorelDraw: **`/Scheme/ROSik_scheme.cdr`**  
* PNG: **`/Scheme/scheme.png`**  
* PDF: **`/Scheme/scheme.pdf`**

–í —Å—Ö–µ–º–µ –ø–æ–∫–∞–∑–∞–Ω—ã:
* –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è (8,4 V ‚Üí 5 V)
* –°–∏–≥–Ω–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –∫ –¥—Ä–∞–π–≤–µ—Ä—É –º–æ—Ç–æ—Ä–æ–≤
* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —ç–Ω–∫–æ–¥–µ—Ä–æ–≤
* –õ–∏–¥–∞—Ä (UART)
* –ò–ö-–¥–∞—Ç—á–∏–∫–∏ (GPIO)

![–°—Ö–µ–º–∞ —Ä–æ–±–æ—Ç–∞](/Scheme/scheme.png)

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤:**
* –õ–µ–≤—ã–π –¥–∞—Ç—á–∏–∫: GPIO 14
* –ü—Ä–∞–≤—ã–π –¥–∞—Ç—á–∏–∫: GPIO 12
* –ü–∏—Ç–∞–Ω–∏–µ: 5V
* –ó–µ–º–ª—è: GND

---

## üñ® <a id="3d-–º–æ–¥–µ–ª–∏-–∏-—Å–±–æ—Ä–∫–∞">3D-–º–æ–¥–µ–ª–∏ –∏ —Å–±–æ—Ä–∫–∞</a>

–ö–∞—Ç–∞–ª–æ–≥ **`/3D`** —Å–æ–¥–µ—Ä–∂–∏—Ç:
* –§–∞–π–ª—ã SolidWorks (`.SLDPRT/.SLDASM`)
* –ì–æ—Ç–æ–≤—ã–µ `.STL` –¥–ª—è –ø–µ—á–∞—Ç–∏
* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –∫—Ä–µ–ø–ª–µ–Ω–∏—è–º–∏ –¥–ª—è –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤

![3D-–º–æ–¥–µ–ª—å](images/3d.png)
* | `00 - WheelLayer.*`    | –ù–∏–∂–Ω—è—è –ø–ª–∏—Ç–∞ —Å –º–æ—Ç–æ—Ä–∞–º–∏ –∏ –ò–ö-–¥–∞—Ç—á–∏–∫–∞–º–∏
* | `01 - LidarLayer.*`    | –í–µ—Ä—Ö–Ω—è—è –ø–ª–∏—Ç–∞ –ø–æ–¥ –ª–∏–¥–∞—Ä 
* | `10 - ESPLayer.*`      | –°—Ä–µ–¥–Ω—è—è –ø–ª–∏—Ç–∞ –ø–æ–¥ ESP32 –∏ –¥—Ä–∞–π–≤–µ—Ä 
* | `Bracket.* / Holder.*` | –ö—Ä–µ–ø—ë–∂ –º–æ—Ç–æ—Ä–æ–≤, DC-DC, –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
* | `RosikAssambl.SLDASM`  | –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ 
* | `STL/`                 | –§–∞–π–ª—ã –¥–ª—è –ø–µ—á–∞—Ç–∏ (0,2 –º–º, PLA) 
* | `ROSik.png`            | –†–µ–Ω–¥–µ—Ä –∏—Ç–æ–≥–æ–≤–æ–≥–æ –≤–∏–¥–∞ 

**–°–±–æ—Ä–∫–∞:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ò–ö-–¥–∞—Ç—á–∏–∫–∏ –Ω–∞ –Ω–∏–∂–Ω–∏–π —Å–ª–æ–π (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–ø–µ—Ä–µ–¥)
2. –ü—Ä–æ–ª–æ–∂–∏—Ç–µ –ø—Ä–æ–≤–æ–¥–∞ –∫ ESP32 —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–∞–Ω–∞–ª—ã
3. –°–æ–±–∏—Ä–∞–π—Ç–µ —Å–Ω–∏–∑—É ‚Üí –≤–≤–µ—Ä—Ö, —Ñ–∏–∫—Å–∏—Ä—É—è —Å–ª–æ–∏ —Å—Ç–æ–π–∫–∞–º–∏ M3 √ó 20 –º–º

---

## üî•<a id="–ø—Ä–æ—à–∏–≤–∫–∞-esp32"> –ü—Ä–æ—à–∏–≤–∫–∞ ESP32 </a>

### –¢—Ä–µ–±—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (Arduino IDE)

* –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ZIP-—Ñ–∞–π–ª—ã –∏–∑ `/esp32_libraries/` –≤ `Documents/Arduino/libraries`  
* –î–æ–±–∞–≤—å—Ç–µ –ø–ª–∞—Ç—É ESP32: `File ‚Üí Preferences ‚Üí Additional URL` ‚Üí `https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json`
* –ß–µ—Ä–µ–∑ Board Manager –¥–æ–±–∞–≤—å—Ç–µ ESP32

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ –¥–ª—è –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤

–í —Ñ–∞–π–ª–µ **`/esp32_firmware/esp32_firmware.ino`** –¥–æ–±–∞–≤–ª–µ–Ω—ã:
1. –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
2. –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ WebSocket
3. –õ–æ–≥–∏–∫–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π

**–®–∞–≥–∏ –ø—Ä–æ—à–∏–≤–∫–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–µ—Ç—á –≤ Arduino IDE
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   ```cpp
   const char* ssid = "your_SSID";
   const char* password = "your_PASSWORD";
   const int IR_LEFT_PIN = 34;
   const int IR_RIGHT_PIN = 35;
   const int IR_THRESHOLD = 2000; // –ü–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É (Ctrl + U)

–í Serial Monitor (115200 baud) –ø–æ—è–≤–∏—Ç—Å—è IP –∏ –¥–∞–Ω–Ω—ã–µ –¥–∞—Ç—á–∏–∫–æ–≤

<a id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-pid">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PID –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–±–æ—Ç–∞</a>
–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Å –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤:
https:///pythonGUI/gui.png

–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è

üêß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ù–æ–¥—ã –≤ ROS2
bash
# 1. –°–æ–∑–¥–∞—ë–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p ~/ros2_ws/src && cd ~/ros2_ws/src

# 2. –ö–æ–ø–∏—Ä—É–µ–º esp32_bridge –≤ ~/ros2_ws/src

# 3. –°–±–æ—Ä–∫–∞
cd ~/ros2_ws
colcon build
source install/setup.bash
–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:

–ù–æ–≤—ã–π —Ç–æ–ø–∏–∫ /ir_sensors —Å –¥–∞–Ω–Ω—ã–º–∏ –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ esp32_bridge/config

üöÄ<a id="–∑–∞–ø—É—Å–∫-ros-2-–Ω–æ–¥"> –ó–∞–ø—É—Å–∫ ROS 2-–Ω–æ–¥ </a>
–ö–æ–º–∞–Ω–¥–∞	–û–ø–∏—Å–∞–Ω–∏–µ
ros2 run esp32_bridge esp32_bridge --ros-args -p host:=<IP_ESP32>	–ó–∞–ø—É—Å–∫ –º–æ—Å—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
ros2 topic echo /ir_sensors	–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
ros2 launch nav2_bringup navigation_launch.py params_file:=~/ros2_ws/src/esp32_bridge/config/nav_param.yaml	–ù–∞–≤–∏–≥–∞—Ü–∏—è —Å —É—á–µ—Ç–æ–º –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ nav_param.yaml:

yaml
ir_sensors:
  enabled: true
  safety_distance: 0.15  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –¥–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
üìä –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å –ò–ö-–¥–∞—Ç—á–∏–∫–∞–º–∏
python
# –ü—Ä–∏–º–µ—Ä –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –¥–∞–Ω–Ω—ã–µ –ò–ö-–¥–∞—Ç—á–∏–∫–æ–≤
import rclpy
from rclpy.node import Node
from std_msgs.msg import Int32MultiArray

class IRSubscriber(Node):
    def __init__(self):
        super().__init__('ir_subscriber')
        self.subscription = self.create_subscription(
            Int32MultiArray,
            '/ir_sensors',
            self.listener_callback,
            10)
        
    def listener_callback(self, msg):
        left, right = msg.data
        self.get_logger().info(f'IR Sensors: L={left}, R={right}')

def main(args=None):
    rclpy.init(args=args)
    node = IRSubscriber()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
